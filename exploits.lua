local gui = Instance.new("ScreenGui")
gui.Name = "heavenluas.gg Exploits"
gui.Parent = game.Players.LocalPlayer.PlayerGui

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 200, 0, 150)
frame.Position = UDim2.new(0, 10, 0, 10)
frame.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
frame.Parent = gui

local redButton = Instance.new("TextButton")
redButton.Size = UDim2.new(1, 0, 0, 50)
redButton.Position = UDim2.new(0, 0, 0, 0)
redButton.Text = "heavenluas.gg Red Body"
redButton.BackgroundColor3 = Color3.new(1, 0, 0)
redButton.Parent = frame

local flyButton = Instance.new("TextButton")
flyButton.Size = UDim2.new(1, 0, 0, 50)
flyButton.Position = UDim2.new(0, 0, 0, 50)
flyButton.Text = "heavenluas.gg Fly"
flyButton.BackgroundColor3 = Color3.new(0, 1, 0)
flyButton.Parent = frame

local walkSpeedSlider = Instance.new("Slider")
walkSpeedSlider.Size = UDim2.new(1, 0, 0, 50)
walkSpeedSlider.Position = UDim2.new(0,0,0,100)
walkSpeedSlider.Min = 16
walkSpeedSlider.Max = 100
walkSpeedSlider.Value = 16
walkSpeedSlider.Parent = frame

local walkSpeedLabel = Instance.new("TextLabel")
walkSpeedLabel.Size = UDim2.new(1, 0, 0, 25)
walkSpeedLabel.Position = UDim2.new(0,0,0,75)
walkSpeedLabel.Text = "heavenluas.gg Walkspeed"
walkSpeedLabel.BackgroundColor3 = Color3.new(0.4,0.4,0.4)
walkSpeedLabel.Parent = frame

local flyEnabled = false

redButton.MouseButton1Click:Connect(function()
    local player = game.Players.LocalPlayer
    local character = player.Character

    if character then
        local humanoid = character:FindFirstChild("Humanoid")
        if humanoid then
            local redColor = Color3.new(1, 0, 0)
            local function setBodyColor(part)
                if part:IsA("BasePart") then
                    part.Color = redColor
                end
            end
            for _, part in pairs(character:GetDescendants()) do
                setBodyColor(part)
            end

            local remote = Instance.new("RemoteEvent")
            remote.Name = "heavenluas.gg RedBodyRemote"
            remote.Parent = character
            remote:FireServer(redColor)

            remote.OnClientEvent:Connect(function(color)
                for _, part in pairs(character:GetDescendants()) do
                    setBodyColor(part)
                end
            end)
        end
    end
end)

flyButton.MouseButton1Click:Connect(function()
    flyEnabled = not flyEnabled
    local player = game.Players.LocalPlayer
    local character = player.Character
    local humanoid = character:FindFirstChild("Humanoid")

    if flyEnabled then
        humanoid.WalkSpeed = 0
        local bodyGyro = Instance.new("BodyGyro")
        bodyGyro.Parent = character.HumanoidRootPart
        local bodyVelocity = Instance.new("BodyVelocity")
        bodyVelocity.Parent = character.HumanoidRootPart

        local connection
        connection = game:GetService("RunService").Stepped:Connect(function()
            if not flyEnabled then
                connection:Disconnect()
                humanoid.WalkSpeed = walkSpeedSlider.Value
                bodyGyro:Destroy()
                bodyVelocity:Destroy()
                return
            end
            bodyGyro.CFrame = character.HumanoidRootPart.CFrame
            bodyVelocity.Velocity = Vector3.new(0, 50, 0)
        end)
    else
        humanoid.WalkSpeed = walkSpeedSlider.Value
        local bodyGyro = character.HumanoidRootPart:FindFirstChild("BodyGyro")
        local bodyVelocity = character.HumanoidRootPart:FindFirstChild("BodyVelocity")
        if bodyGyro then bodyGyro:Destroy() end
        if bodyVelocity then bodyVelocity:Destroy() end
    end
end)

walkSpeedSlider:GetPropertyChangedSignal("Value"):Connect(function()
    local player = game.Players.LocalPlayer
    local character = player.Character
    local humanoid = character:FindFirstChild("Humanoid")
    if humanoid and not flyEnabled then
        humanoid.WalkSpeed = walkSpeedSlider.Value
    end
end)

--Server side remote event.
game.Players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function(character)
        local remote = character:FindFirstChild("heavenluas.gg RedBodyRemote")
        if remote then
            remote.OnServerEvent:Connect(function(player, color)
                for _, otherPlayer in pairs(game.Players:GetPlayers()) do
                    if otherPlayer.Character then
                        for _, part in pairs(otherPlayer.Character:GetDescendants()) do
                            if part:IsA("BasePart") then
                                part.Color = color
                            end
                        end
                    end
                end
            end)
        end
    end)
end)
